#!/usr/bin/env bash

# Bootstrap a new Mac

set -e

# Symlink config files
# Do this first in to simplify updating this configuration.
ln gitconfig ~/.gitconfig
ln gitignore ~/.gitignore
ln editorconfig ~/.editorconfig
ln vimrc ~/.vimrc
ln -s "`pwd`/git_hooks" ~/.git_hooks

# Configure ZSH
## Install zprezto
git clone --recursive https://github.com/sorin-ionescu/prezto.git ~/.zprezto
## Install a Powerline Font for prompt theme
open "./fonts/Inconsolata for Powerline.otf"
ln zpreztorc ~/.zpreztorc
ln zshenv ~/.zshenv
ln zshrc ~/.zshrc
ln -s "`pwd`/zsh" ~/.zsh

# Generate an SSH key
ssh-keygen -t rsa -N "" -f ~/.ssh/id_rsa

# Install homebrew (also install xcode tools)
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/HomeBrew/install/master/install)"
brew doctor
mkdir -p ~/Library/LaunchAgents

brew install git hub nodenv
brew tap nodenv/nodenv
brew install nodenv-package-rehash

# Install VSCode and extensions
brew cask install visual-studio-code
code --install-extension vscodevim.vim

# Install homebrew cask for Mac apps
brew cask install dropbox google-chrome nvalt visual-studio-code

# Install QuickLook plugins
# details at https://github.com/sindresorhus/quick-look-plugins
brew cask install qlstephen qlmarkdown

# Create projects directory
mkdir -p ~/Projects

# Use OSX keychain for git auth
# https://help.github.com/articles/caching-your-github-password-in-git/
git config --global credential.helper osxkeychain

# Create a github access token
open "https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/"


